# Happy_style_bot
Этот бот основан на fast-neural-style(https://github.com/pytorch/examples/tree/master/fast_neural_style)
## Запуск
1) Для того, чтобы опробовать его в действии для начала необходимо создать файл telegram_token.py в папке bot_utils, сделать это можно при помощи файла go_bot.py и команды:
```bash
python go_bot.py
```
После выполнения команды, в окно необходимо вписать токен вашего бота полученного от @BotFather.

2) После того, как Вы создали требуемый telegram_token.py с токеном, следующим шагом станет запуск самого бота командой:
```bash
python bot.py
```
Все, бот работает, теперь нужно лишь зайти в telegram и начать с ним разговор, либо ввести /start, если разговор уже начат.
## Тренировка моделей с собственным стилем
Чтобы, натеренеровать модель с собственным стилем необзодимо выполнить такую команду:
```bash
python training.py --dataset </path/to/train-dataset> --style-image </path/to/style/image> --save-model-dir </path/to/save-model/folder> --epochs 2 --cuda 1
```
Есть множество параметров, которые можно задать при тренировке модели, самые важные описаны снизу, для просмотра других пропишите 
--help в команде сверху.
* `--dataset`: Путь к тренировочному датасету, путь должен быть указан к папке, содержащей другую папку, уже в которой расположены все тренировочные изображения. Я использовал для тренировки своих моделей COCO 2017 val dataset[5K/1GB] при тренировке оригинальных моделей fast-neural-style был использован COCO 2014 training dataset [80K/13GB] [(download)](http://mscoco.org/dataset/#download).
* `--style-image`: Путь к картинке со стилем.
* `--save-model-dir`: Путь к папке, куда будет сохранена натренерованная модель..
* `--cuda`: Поставьте 1 чтобы тренировать на GPU, 0 для CPU.
## Примечание
Все ответы бота и url фотографий, которые он использует вынесены в отдельный файл config.py, так что их можно отредактировать там.
## Бонус
В папке heroku располагается бот, который был запущен на удаленном сервере heroku, для этого пришлось полностью переделать файл neyral_style_with_your_image и отказаться от очень тяжелой сети VGG в пользу легкой SqueezeNet + поставить порог на размер входных изображений для ресайза в utils.

Чтобы запустить бота на heroku необходимо скинуть все, то лежит в папке heroku в свой репозиторий (приватный, потому что иначе будет виден токен твоего бота, который придется держать в репозитории все время), также выполнить go_bot.py и, зарегистрируясь на heroku, нажать на New и выбрать - загрузить из git hub репозитория, выбрать свой репозиторий... deploy и все, бот живет )
